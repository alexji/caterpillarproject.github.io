<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Creating Digests Of The Astronomy Arxiv</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Does the genre of an artist determine their lifespan?">
  <!-- rss feed -->
  <link rel="alternate" type="application/rss+xml" 
  title="RSS Feed for brendangriffen.com" 
  href="http://feeds.feedburner.com/brendangriffen" />

  <!-- favicon -->
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="http://brendangriffen.com/assets/">
  <meta name="twitter:title" content="Creating Digests Of The Astronomy Arxiv">
  <meta name="twitter:description" content="Does the genre of an artist determine their lifespan?">
  <meta name="twitter:creator" content="@_sebu_">

  <!-- Open Graph -->
  <meta property="fb:admins" content="673372761">
  <meta property="fb:app_id" content="646320802089541">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
  <meta property="og:image" content="http://sebpearce.com/assets/">
  <meta property="og:title" content="Creating Digests Of The Astronomy Arxiv">
  <meta property="og:description" content="Does the genre of an artist determine their lifespan?">
  <meta property="og:url" content="http://brendangriffen.com/blog/creating-digests-of-ads/">
  <meta property="og:site_name" content="brendangriffen.com">

  <link href='http://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,700italic,700,300' rel='stylesheet' type='text/css'>

  <!-- font-awesome CSS -->
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/main.css">        

  <!-- syntax highlighting CSS -->
  <link rel="stylesheet" href="/css/syntax.css">

</head>
<body>
    
  

<div class="masthead">
  <div class="masthead-container">
    <div class="rootlink-container">
      <a href="/" class="rootlink">
        <h3 class="myname">Brendan Griffen</h3><br>
        <!--<h4 class="mydescription">Astrophysicist.</h4> -->
      </a>
    </div>
    <ul class="main-menu"><a href="/"><li>Blog</li></a>
      <a href="/projects/"><li>Projects</li></a>
      <a href="/about/"><li>About</li></a>
      <a href="/vitae/"><li>Vitae</li></a>
      <a href="/contact"><li>Contact</li></a>
        <!-- <li><a target="_blank" href="http://feedburner.google.com/fb/a/mailverify?uri=brendangriffen&amp;loc=en_US"> -->
      <!-- <a target="_blank" href="http://feedburner.google.com/fb/a/mailverify?uri=brendangriffen&amp;loc=en_US"><li>Subscribe</li></a> -->
    </ul>
    <ul class="socialmedia">
      <li title="GitHub"><a href="http://github.com/bgriffen" class="fa fa-github fa-2x" rel="nofollow"></a></li>
      <li title="Email"><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;brendan.f.griffen&#64;gmail.com" class="fa fa-envelope fa-2x"></a></li>
      <li title="Twitter"><a href="http://twitter.com/brendangriffen" class="fa fa-twitter fa-2x"></a></li>
      <li title="RSS"><a href="http://feeds.feedburner.com/brendangriffen" class="fa fa-rss-square fa-2x"></a></li>
    </ul>
    <div style="clear:both;"></div>
  </div> <!-- end of masthead-container -->
</div> <!-- end of masthead -->


    
    <article>
      <div class="content">

        <h1>Creating Digests Of The Astronomy Arxiv</h1>
<p class="meta">04 November 2014</p>


<div class="post">
  <p>I took another look at <a href="https://github.com/andycasey/ads">ADS-python</a> (a python tool for ADS) developed by <a href="http://astrowizici.st/">Andy Casey</a>. I modified his example script to email myself a digest of all of the papers published by my institute in the past month. I set it up as an automated cron job (<code>10 0 1 * * python script.py</code>) to be run on the 1st of each month so I don&#39;t have to run the script anymore to get the digest. You will need <a href="https://github.com/alexandrevicenzi/fluentmail">FluentMail</a> for this to work. You will also need to allow Gmail to receive login requests from less familiar apps. If you want to use a different email client see <a href="https://github.com/alexandrevicenzi/fluentmail#common-smtp-servers">here</a>. I&#39;ve setup a <a href="http://www.github.com/bgriffen/ads.git">GitHub repository</a> for these codes and future codes relating to work done with ADS.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"># Core libraries
from time import localtime
import sys,os
import subprocess as sub

# Module Libraries
import ads
from fluentmail import FluentMail

mail = FluentMail(&#39;smtp.gmail.com&#39;, 465, &#39;SSL&#39;)
email_address = &#39;brendan.f.griffen@gmail.com&#39;
email_password = &#39;password&#39;
output_directory = &quot;./&quot;
download_papers = False
my_affiliation = &#39;&quot;Kavli Institute For Astrophysics&quot;&#39;

if __name__ == &quot;__main__&quot;:

    # Let&#39;s do it for *last* month
    current_time = localtime()

    # Last month
    year = current_time.tm_year - 1 if current_time.tm_mon == 1 else current_time.tm_year
    month = current_time.tm_mon - 1 if current_time.tm_mon &gt; 1 else 12
    
    # Get all the articles
    articles1 = ads.search(
        affiliation=my_affiliation,
        filter=&quot;database:astronomy AND property:refereed&quot;,
        dates=&quot;{year}/{month}&quot;.format(year=year, month=month))

    articles = list(articles1)
    print(&quot;There were {0} articles found for {year}/{month} with MKI co-authors.&quot;.format(len(articles),year=year, month=month))

    # Sort articles
    sorted_articles = sorted(articles,
        key=lambda article: [(my_affiliation.strip(&#39;&quot;&#39;).lower() in affiliation.lower()) for affiliation in article.aff].index(True))

    # Option to download these papers
    if download_papers:
        output_folder = output_directory + &quot;{year}_{month}&quot;.format(year=year,month=month)
        cmd_make_this_months_folder = &quot;mkdir -p &quot; + output_folder
        sub.call([cmd_make_this_months_folder],shell=True)

        filename = output_folder + &quot;/&quot; + article.bibcode + &quot;.pdf&quot;
        if not os.path.isfile(filename):
            ads.retrieve_article(article, output_filename=output_folder + &quot;/&quot; + article.bibcode + &quot;.pdf&quot;)

    # Construct email content
    email_content = &quot;There were {num} articles published by astronomy researchers from the {my_affiliation} last month ({year}/{month})&quot;\
                    .format(num=len(articles),my_affiliation=my_affiliation,year=year,month=month)

    for article in sorted_articles:
        email_content += article.author[0].split(&quot;,&quot;)[0] + &quot; et al.\n&quot; +\
                         article.title[0] + &quot;\n&quot; + article.abstract + &quot;\n&quot; +\
                         article.url + &quot;\n\n&quot;

    # Email yourself the digest
    mail.credentials(email_address, email_password)\
    .from_address(email_address).to(email_address)\
    .subject(&#39;Monthly Institute Arxiv Digest&#39;)\
    .body(email_content)\
    .send()</code></pre></div>

<p>Here is an example of what one of these emails might look like:</p>

<p><a href="/assets/adspython/monthly_arxiv_digest.png"><img src="/assets/adspython/monthly_arxiv_digest.png" alt="Digest"></a></p>

<p>I usually read new papers through my RSS reader <a href="http://www.feedly.com">Feedly</a>, which has a feature which tells you roughly how many people have also bookmarked that paper (see the left side). I think this is a rough proxy for &#39;interest&#39; and I often take more notice of papers with a high number of bookmarks.</p>

<p><a href="/assets/adspython/feedly_popular_papers.png"><img src="/assets/adspython/feedly_popular_papers.png" alt="Most popular"></a></p>

<p>I wanted a &#39;top 10 most popular&#39; list from the ADS listings from &#39;yesterday&#39; - whenever that may be. It is convenient to know what is making headlines in the community.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"># Core libraries
from time import localtime
import numpy as np

# Module Libraries
import ads
from fluentmail import FluentMail

mail = FluentMail(&#39;smtp.gmail.com&#39;, 465, &#39;SSL&#39;)
email_address = &#39;brendan.f.griffen@gmail.com&#39;
email_password = &#39;password&#39;
email_content = &quot;&quot;

if __name__ == &quot;__main__&quot;:
    current_time = localtime()
    year = current_time.tm_year
    month = current_time.tm_mon
    day = current_time.tm_mday-1 # yesterday
    
    # Get papers
    papers = list(ads.query(dates=&quot;{year}/{month}/{day}&quot;\
            .format(year=year, month=month, day=day),filter=&quot;database:astronomy&quot;, rows=200))

    # Get number of reads
    num_reads_list = []
    for paper in papers:
        num_reads = paper.metrics[&#39;all_reads&#39;][&#39;Total_number_of_reads&#39;]
        num_reads_list.append(num_reads)
    
    idx_num_reads = np.argsort(np.array(num_reads_list))[::-1]
    
    # Construct email content
    email_content = &quot;Top viewed papers for {day}/{month}/{year}\n\n&quot;\
                    .format(year=year, month=month, day=day)

    for idx,i in enumerate(idx_num_reads[:10]):
        email_content += str(idx+1) + &quot;. &quot; + \
        papers[i].author[0].split(&quot;,&quot;)[0] + &quot; et al. &gt; # reads: &quot; + \
        str(papers[i].metrics[&#39;all_reads&#39;][&#39;Total_number_of_reads&#39;]) + &quot;\n&quot; + \
        papers[i].title[0] + &quot;\n&quot; + \
        papers[i].abstract + &quot;\n&quot; + \
        papers[i].url + &quot;\n\n&quot;
    
    print email_content
    # Email content
    mail.credentials(email_address, email_password)\
    .from_address(email_address)\
    .to(email_address)\
    .subject(&quot;Yesterday&#39;s most popular papers!&quot;)\
    .body(email_content)\
    .send()</code></pre></div>

<p>Here is an example of what one of these emails might look like:</p>

<p><a href="/assets/adspython/yesterdays_most_popular.png"><img src="/assets/adspython/yesterdays_most_popular.png" alt="Most popular"></a></p>

<p>This is really only the beginning of the sort of thing you can do with nice Python-esk access to the ADS database.</p>

</div>

<div class="footer">

  Share:
  <span class="social">
    <a class="facebook-share" href="http://www.facebook.com/sharer/sharer.php?app_id=646320802089541&u=http://brendangriffen.com/blog/creating-digests-of-ads/" onclick="javascript:window.open(this.href,
    '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600');return false;">
      <i class="fa fa-facebook-square"></i>
    </a>&nbsp;
    <a class="twitter-share" href="https://twitter.com/share?url=&text=Creating Digests Of The Astronomy Arxiv+(via+@brendangriffen)" onclick="javascript:window.open(this.href,
    '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=260,width=600');return false;">
      <i class="fa fa-twitter-square"></i>
    </a>&nbsp;
    <a class="google-share" href="https://plus.google.com/share?url=http://brendangriffen.com/blog/creating-digests-of-ads/" onclick="javascript:window.open(this.href,
    '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
        <i class="fa fa-google-plus-square"></i>
    </a>
  </span>
  <br>
  Follow: <strong><a class="follow-me-link" href="https://twitter.com/brendangriffen">@brendangriffen</a></strong>

</div>


<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'brendangriffen'; // required: replace example with your forum shortname
    var disqus_identifier = '/blog/creating-digests-of-ads';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        
      </div> <!-- end of content -->
    </article>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-48672309-1', 'brendangriffen.com');
  ga('send', 'pageview');
  </script>

</body>
</html>
